package net.nitroservices.rezan.mlforandroidmalwaredetection;

import android.content.Intent;
import android.os.Environment;
import android.support.v7.app.AppCompatActivity;
import android.os.Bundle;
import android.util.Log;

import java.io.BufferedReader;
import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileReader;
import java.io.IOException;

import weka.classifiers.Evaluation;
import weka.classifiers.bayes.NaiveBayes;
import weka.core.Debug;
import weka.core.Instances;

public class MainActivity extends AppCompatActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);


        try {
            String fileName = "airline.arff";

            // Find the directory for the SD Card using the API
            // Don't hardcode "/sdcard"
            // File sdcard = Environment.getExternalStorageDirectory();

            // Get arff file
            // File file = new File(sdcard, fileName);
            File file = new File("/storage/44B4-941B/airline.arff");


            BufferedReader bufferedReader = new BufferedReader(new FileReader(file));
            Instances train = new Instances(bufferedReader);
            train.setClassIndex(train.numAttributes() -1);
            NaiveBayes naiveBayes = new NaiveBayes();
            naiveBayes.buildClassifier(train);
            Evaluation evaluation = new Evaluation(train);
            evaluation.crossValidateModel(naiveBayes, train, 10, new Debug.Random(1));

            Log.i("Test Output fMeasure: ", String.valueOf(evaluation.fMeasure(1)));
            Log.i("Test Output precision: ", String.valueOf(evaluation.precision(1)));
            Log.i("Test Output recall: ", String.valueOf(evaluation.recall(1)));

        }
        catch (IOException e) {
            Log.i("Test 1", "Test1");
            e.printStackTrace();
        }
        catch (Exception e) {
            Log.i("Test 2", "Test2");
            e.printStackTrace();
        }


        Intent installedAppActivity = new Intent(MainActivity.this, InstalledAppsActivity.class);
        startActivity(installedAppActivity);

    }
}
